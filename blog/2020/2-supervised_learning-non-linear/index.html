<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Part2: Supervised Learning: Extending to higher dimensions and non-linear regression | Ashith Shyam Babu, PhD </title> <meta name="author" content="Ashith Shyam Babu, PhD"> <meta name="description" content="Building blocks of supervised learning"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%94%A5&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ashbabu.github.io/blog/2020/2-supervised_learning-non-linear/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ashith</span> Shyam Babu, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">blog </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/blog/category/robotics/">Robotics</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/programming/">Programming</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/computer-vision/">Computer Vision</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/reinforcement-learning/">Reinforcement Learning</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/machine-learning/">Machine Learning</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/contact/">contact </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Part2: Supervised Learning: Extending to higher dimensions and non-linear regression</h1> <p class="post-meta"> February 17, 2020 </p> <p class="post-tags"> <a href="/blog/2020"> <i class="fa-solid fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/category/machine-learning"> <i class="fa-solid fa-tag fa-sm"></i> Machine-Learning</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p> In <a href="/blog/2020/1-supervised_learning-basic/">Part1</a>, the aim was to predict house prices given the number of bedrooms. What if the house prices are dependant not just on the number of bedrooms but on other parameters as well, for instance, floor area. Let’s build a mathematical model for the same and it isn’t too much different from <a href="/blog/2020/1-supervised_learning-basic/">Part1</a>’s model.</p> <p><br></p> <h4 id="mathematical-model-2">Mathematical model 2:</h4> <p>\begin{align} y = w_0 + w_1 \times nB + w_2 \times fA \label{line1} \end{align} where <code class="language-plaintext highlighter-rouge">w's</code> are weights that need to be found out and <code class="language-plaintext highlighter-rouge">nB</code> and <code class="language-plaintext highlighter-rouge">fA</code>’s (or <code class="language-plaintext highlighter-rouge">x</code>) are respectively the number of bedrooms and floor area in square units.</p> <p><code class="language-plaintext highlighter-rouge">house prices, (y):</code> 150k, 220k, 320k <br> <code class="language-plaintext highlighter-rouge">Number of bedrooms, (nB):</code> 1, 2, 3<br> <code class="language-plaintext highlighter-rouge">Floor Area, (fA):</code> 42, 59, 61</p> <p>\begin{align} Y &amp;= \begin{bmatrix} 1 &amp; nB &amp; fA \end{bmatrix} \begin{bmatrix} w_0 \nonumber \newline w_1 \nonumber \newline w_2 \end{bmatrix} \newline &amp;= X^Tw \end{align} The matrix equation becomes \begin{align} \begin{bmatrix} 150 \nonumber \newline 220 \nonumber \newline 320 \end{bmatrix} = \begin{bmatrix} 1 &amp; 1 &amp; 42 \nonumber \newline 1 &amp; 2 &amp; 59 \nonumber \newline 1 &amp; 3 &amp; 61 \end{bmatrix} \begin{bmatrix} w_0 \nonumber \newline w_1 \nonumber \newline w_2 \end{bmatrix} \end{align}</p> <p>The equation to find the parameters would remain the same as in Part1 (reproduced in eq. \ref{parameter}), the change being in the feature matrix and also an added parameter (<code class="language-plaintext highlighter-rouge">w_2</code>). \begin{align} w = (X^TX)^{-1}X^TY \label{parameter} \end{align}</p> <p>Code in <code class="language-plaintext highlighter-rouge">Python</code> to solve the same</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>       <span class="c1"># library for mathematics (linear algebra)
</span>
<span class="n">nB</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="p">])</span>  <span class="c1"># Num bedrooms
</span><span class="n">fA</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">42.0</span><span class="p">,</span> <span class="mf">59.0</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">])</span>  <span class="c1"># Floor area
</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">220.0</span><span class="p">,</span> <span class="mf">320.0</span><span class="p">])</span>  <span class="c1"># Cost
</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nB</span><span class="p">)).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">nB</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fA</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">X</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">Y</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># To find parameters
</span><span class="nf">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">######
</span><span class="p">[</span><span class="mf">130.0</span><span class="p">,</span> <span class="mf">104.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">]</span>
</code></pre></div></div> <p><br></p> <h4 id="non-linear-regression">Non-linear regression</h4> <p>The above case can be extended to non-linear cases as long as the weight vector \(w\) stays linear</p> <p>\begin{align} y = \phi(x)^T w \end{align}</p> <p>where \(\phi(x)\) can be a polynomial or radial basis or any other functions. The non-linear case for our house pricing example can be written explicitly as \begin{align} y &amp;= w_0 + w_1 \times nB^2 + w_2 \times fA^2 \nonumber \newline &amp;= \begin{bmatrix} 1 &amp; nB^2 &amp; fA^2 \end{bmatrix} \begin{bmatrix} w_0 \nonumber \newline w_1 \nonumber \newline w_2 \end{bmatrix} \newline &amp;= \phi(x)^Tw \label{eq:non-linear} \end{align}</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">nB</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">fA</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">X</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">Y</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># To find parameters
</span><span class="nf">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">######
</span><span class="p">[</span><span class="mf">119.1</span><span class="p">,</span> <span class="mf">19.69</span><span class="p">,</span> <span class="mf">0.00635</span><span class="p">]</span>
</code></pre></div></div> <p>The \(\phi(x)\) in eq. \ref{eq:non-linear} is just one of the many forms \(\phi(x)\) can take. Another possible one could be \begin{align} y &amp;= w_0 + w_1 \times nB^2 + w_2 \times fA^2 + w_3 \times nB \times fA \nonumber \newline &amp;= \begin{bmatrix} 1 &amp; nB^2 &amp; fA^2 &amp; nB \times fA \end{bmatrix} \begin{bmatrix} w_0 \nonumber \newline w_1 \nonumber \newline w_2 \nonumber \newline w_3 \end{bmatrix} \newline &amp;= \phi(x)^Tw \nonumber \end{align}</p> <p><br></p> <h4 id="a-few-points-to-note">A few points to note</h4> <p>I mentioned about some small techiques used in practice to get better estimates of the parameters.</p> <ul> <li>One of the most important one is <a href="https://en.wikipedia.org/wiki/Feature_scaling" rel="external nofollow noopener" target="_blank">Feature Scaling</a>. There are also a lot of other resources available on this and it’s beyond the scope to discuss it here.</li> <li>What happens if the feature matrix is singular? I will briefly touch upon this in <a href="/blog/2020/3-supervised_learning-ridge/">Ridge regression</a> </li> <li>What happens if the data is non-linear? A short intro to <a href="/blog/2020/4-supervised_learning-weighted/">locally weighted regression</a> can be found here</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/1-supervised_learning-basic/">Part1: Supervised Learning: Basic linear regression</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Jacobian/">Jacobian</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/Custom_Inverse_Kinematics_MoveIt_Plugin/">Custom Inverse Kinematics MoveIt Plugin</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/Inverse_kinematics_solutions/">Inverse Kinematics Solutions: Analytic and Optimization Based Approaches</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/5-supervised_learning-Probabilistic/">Part5: Supervised Learning: Probabilistic regression</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Ashith Shyam Babu, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> </body> </html>