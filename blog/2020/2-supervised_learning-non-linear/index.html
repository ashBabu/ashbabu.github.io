<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ashith Shyam Babu, PhD | Part2: Supervised Learning: Extending to higher dimensions and non-linear regression</title>
    <meta name="author" content="Ashith Shyam Babu, PhD" />
    <meta name="description" content="Building blocks of supervised learning" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¥</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://ashbabu.github.io/blog/2020/2-supervised_learning-non-linear/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://ashbabu.github.io/"><span class="font-weight-bold">Ashith</span> Shyam  Babu, PhD</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">blog</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/blog/category/robotics/">Robotics</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/blog/category/programming/">Programming</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/blog/category/computer-vision/">Computer Vision</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/blog/category/reinforcement-learning/">Reinforcement Learning</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/blog/category/machine-learning/">Machine Learning</a>
                </div>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/contact/">contact</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/">teaching</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Part2: Supervised Learning: Extending to higher dimensions and non-linear regression</h1>
    <p class="post-meta">February 17, 2020</p>
    <p class="post-tags">
      <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>
      Â  Â· Â 
        <a href="/blog/category/Machine-Learning">
          <i class="fas fa-tag fa-sm"></i> Machine-Learning</a> Â 
          

    </p>
  </header>

  <article class="post-content">
    <!-- <div style="text-align: justify"> <a href="https://www.ros.org/"> ROS </a> -->
<p><!-- </div> -->
In <a href="/blog/2020/1-supervised_learning-basic/">Part1</a>, the aim was to predict house prices given the number of bedrooms. What if the house prices are dependant not just on the number of bedrooms but on other parameters as well, for instance, floor area. Letâ€™s build a mathematical model for the same and it isnâ€™t too much different from <a href="/blog/2020/1-supervised_learning-basic/">Part1</a>â€™s model.</p>

<p><br></p>

<h4 id="mathematical-model-2">Mathematical model 2:</h4>
<p>\begin{align}
	y = w_0 + w_1 \times nB + w_2 \times fA
	\label{line1}
\end{align}
where <code class="language-plaintext highlighter-rouge">w's</code> are weights that need to be found out and <code class="language-plaintext highlighter-rouge">nB</code> and <code class="language-plaintext highlighter-rouge">fA</code>â€™s (or <code class="language-plaintext highlighter-rouge">x</code>) are respectively the number of bedrooms and floor area in square units.</p>

<p><code class="language-plaintext highlighter-rouge">house prices, (y):</code> 150k, 220k, 320k <br>
<code class="language-plaintext highlighter-rouge">Number of bedrooms, (nB):</code> 1, 2, 3<br>
<code class="language-plaintext highlighter-rouge">Floor Area, (fA):</code> 42, 59, 61</p>

<p>\begin{align}
	Y &amp;= \begin{bmatrix}
           1 &amp; nB &amp; fA
        \end{bmatrix} \begin{bmatrix}
                              w_0 \nonumber \newline
                              w_1 \nonumber \newline
                              w_2
                        \end{bmatrix} \newline
      &amp;= X^Tw
\end{align}
The matrix equation becomes
\begin{align}
	\begin{bmatrix}
		150 \nonumber \newline
		220 \nonumber \newline
		320
    \end{bmatrix}  = \begin{bmatrix}
       					1 &amp; 1 &amp; 42 \nonumber \newline
       					1 &amp; 2 &amp; 59 \nonumber \newline
       					1 &amp; 3 &amp; 61
    				 \end{bmatrix}
        			 \begin{bmatrix}
                      	w_0 \nonumber \newline
                      	w_1 \nonumber \newline
                        w_2
                     \end{bmatrix} 
\end{align}</p>

<p>The equation to find the parameters would remain the same as in Part1 (reproduced in eq. \ref{parameter}), the change being in the feature matrix and also an added parameter (<code class="language-plaintext highlighter-rouge">w_2</code>).
\begin{align}
	w = (X^TX)^{-1}X^TY
	\label{parameter}
\end{align}</p>

<p>Code in <code class="language-plaintext highlighter-rouge">Python</code> to solve the same</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>       <span class="c1"># library for mathematics (linear algebra)
</span>
<span class="n">nB</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="p">])</span>  <span class="c1"># Num bedrooms
</span><span class="n">fA</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">42.0</span><span class="p">,</span> <span class="mf">59.0</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">])</span>  <span class="c1"># Floor area
</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">220.0</span><span class="p">,</span> <span class="mf">320.0</span><span class="p">])</span>  <span class="c1"># Cost
</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nB</span><span class="p">)).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">nB</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fA</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">X</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">Y</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># To find parameters
</span><span class="nf">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">######
</span><span class="p">[</span><span class="mf">130.0</span><span class="p">,</span> <span class="mf">104.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">]</span>
</code></pre></div></div>

<p><br></p>

<h4 id="non-linear-regression">Non-linear regression</h4>
<p>The above case can be extended to non-linear cases as long as the weight vector \(w\) stays linear</p>

<p>\begin{align}
	y = \phi(x)^T w
\end{align}</p>

<p>where \(\phi(x)\) can be a polynomial or radial basis or any other functions.
The non-linear case for our house pricing example can be written explicitly as
\begin{align}
	y &amp;= w_0 + w_1 \times nB^2 + w_2 \times fA^2 \nonumber \newline
	  &amp;= \begin{bmatrix}
           1 &amp; nB^2 &amp; fA^2
        \end{bmatrix} \begin{bmatrix}
                              w_0 \nonumber \newline
                              w_1 \nonumber \newline
                              w_2
                        \end{bmatrix} \newline
      &amp;= \phi(x)^Tw
      \label{eq:non-linear}
\end{align}</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">nB</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">fA</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">X</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">Y</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># To find parameters
</span><span class="nf">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">######
</span><span class="p">[</span><span class="mf">119.1</span><span class="p">,</span> <span class="mf">19.69</span><span class="p">,</span> <span class="mf">0.00635</span><span class="p">]</span>
</code></pre></div></div>
<p>The \(\phi(x)\) in eq. \ref{eq:non-linear} is just one of the many forms \(\phi(x)\) can take. Another possible one could be 
\begin{align}
    y &amp;= w_0 + w_1 \times nB^2 + w_2 \times fA^2 + w_3 \times nB \times fA \nonumber \newline
      &amp;= \begin{bmatrix}
           1 &amp; nB^2 &amp; fA^2 &amp; nB \times fA
        \end{bmatrix} \begin{bmatrix}
                              w_0 \nonumber \newline
                              w_1 \nonumber \newline
                              w_2 \nonumber \newline
                              w_3
                        \end{bmatrix} \newline
      &amp;= \phi(x)^Tw \nonumber
\end{align}</p>

<p><br></p>

<h4 id="a-few-points-to-note">A few points to note</h4>

<p>I mentioned about some small techiques used in practice to get better estimates of the parameters.</p>

<ul>
  <li>One of the most important one is <a href="https://en.wikipedia.org/wiki/Feature_scaling" target="_blank" rel="noopener noreferrer">Feature Scaling</a>. There are also a lot of other resources available on this and itâ€™s beyond the scope to discuss it here.</li>
  <li>What happens if the feature matrix is singular? I will briefly touch upon this in <a href="/blog/2020/3-supervised_learning-ridge/">Ridge regression</a>
</li>
  <li>What happens if the data is non-linear? A short intro to <a href="/blog/2020/4-supervised_learning-weighted/">locally weighted regression</a> can be found here</li>
</ul>

  </article>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        Â© Copyright 2023 Ashith Shyam Babu, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

