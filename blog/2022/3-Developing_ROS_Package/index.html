<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Part3: Developing a ROS C++ package | Ashith Shyam Babu, PhD </title> <meta name="author" content="Ashith Shyam Babu, PhD"> <meta name="description" content="How to make a ROS package"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%94%A5&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ashbabu.github.io/blog/2022/3-Developing_ROS_Package/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ashith</span> Shyam Babu, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">blog </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/blog/category/robotics/">Robotics</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/programming/">Programming</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/computer-vision/">Computer Vision</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/reinforcement-learning/">Reinforcement Learning</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/category/machine-learning/">Machine Learning</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/contact/">contact </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Part3: Developing a ROS C++ package</h1> <p class="post-meta"> January 07, 2022 </p> <p class="post-tags"> <a href="/blog/2022"> <i class="fa-solid fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/category/robotics"> <i class="fa-solid fa-tag fa-sm"></i> Robotics</a>   <a href="/blog/category/programming"> <i class="fa-solid fa-tag fa-sm"></i> Programming</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="gtest-and-rostest"> <em>gTest</em> and <em>rostest</em> </h3> <p>We looked at <em>CMakeLists.txt</em> and <em>package.xml</em> in <a href="/blog/2021/2-Developing_ROS_Package/">Part2</a>. The aim here is to add simple tests to verify the functionality of each of the functions or modules that is added to the project. This will also ensure that the package is not broken by adding something new to the catkin package. At the end of the <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>, add the following</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#############
## Testing ##
#############

## Add gtest based cpp test target and link libraries
if(CATKIN_ENABLE_TESTING)
    find_package(rostest REQUIRED)

    add_rostest_gtest(
        test_one
        test/test_one.test
        test/test_one.cpp
    )
    target_link_libraries(
        test_one
        ${catkin_LIBRARIES}
    )
    add_dependencies(
        test_one
        ${catkin_EXPORTED_TARGETS}
    )

    catkin_add_gtest(
        test_two
        test/test_two.cpp
        src/hello.cpp
        src/add.cpp
    )
    target_link_libraries(
        test_two
        ${catkin_LIBRARIES}
    )
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">rostest</code> is basically the testing of your newly added function or module for compatibility with the ROS ecosystem. This is well documented <a href="http://wiki.ros.org/rostest" rel="external nofollow noopener" target="_blank">here</a>. Add a folder <code class="language-plaintext highlighter-rouge">test</code> in the same level as <code class="language-plaintext highlighter-rouge">include</code> (or <code class="language-plaintext highlighter-rouge">src</code>). <code class="language-plaintext highlighter-rouge">add_rostest_gtest()</code> is the function that enables testing which needs a name (<code class="language-plaintext highlighter-rouge">test_one</code>), a <code class="language-plaintext highlighter-rouge">.test</code> or <code class="language-plaintext highlighter-rouge">.launch</code> file and atleast one source file (<code class="language-plaintext highlighter-rouge">test_one.cpp</code>). The main difference between <code class="language-plaintext highlighter-rouge">rostest</code> and <code class="language-plaintext highlighter-rouge">gtest</code> is the lack of <code class="language-plaintext highlighter-rouge">.test</code> file. The <code class="language-plaintext highlighter-rouge">rostest</code> is invoked by using <code class="language-plaintext highlighter-rouge">rosrun package_name test_one.test</code> where the <code class="language-plaintext highlighter-rouge">test_one.test</code> would contain</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;launch&gt;
    &lt;test pkg="package_name" test-name="test_one" type="test_one" /&gt;
&lt;/launch&gt;

</code></pre></div></div> <p>The structure of <code class="language-plaintext highlighter-rouge">test_one.cpp</code> would be</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;ros/ros.h&gt;
#include &lt;gtest/gtest.h&gt;
#include &lt;my_test_package/greet/hello.h&gt;

TEST(TESTSuite, my_test1)
{
    ros::NodeHandle nh;
    ros::AsyncSpinner spinner(1); spinner.start();

    // define or find out a, b
    EXPECT_EQ(a, b);

    bool success = your_function();
    EXPECT_TRUE(success);
    std::cout&lt;&lt;" ::::::: "&lt;&lt;std::endl;
}

int main(int argc, char **argv)
{
    ros::init(argc, argv, "moveit_ik_solutions");
    testing::InitGoogleTest(&amp;argc, argv);
    return RUN_ALL_TESTS();
}
</code></pre></div></div> <p>The functions <code class="language-plaintext highlighter-rouge">EXPECT_EQ</code> (for equality), <code class="language-plaintext highlighter-rouge">EXPECT_TRUE</code> (for boolean) are used to make sure if the test is run successfully or not. There are other functions as well which are well documented <a href="https://google.github.io/googletest/reference/assertions.html" rel="external nofollow noopener" target="_blank">here</a>. For diving deep, take a look at <a href="https://google.github.io/googletest/" rel="external nofollow noopener" target="_blank">Google Test</a></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/2-Developing_ROS_Package/">Part2: Developing a ROS C++ package</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/Custom_Inverse_Kinematics_MoveIt_Plugin/">Custom Inverse Kinematics MoveIt Plugin</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/1-Developing_ROS_Package/">Part1: Developing a ROS C++ package</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/1-supervised_learning-basic/">Part1: Supervised Learning: Basic linear regression</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Obstacle-Detection-from-Pointclouds/">Obstacle Detection from Pointclouds on Raspberry Pi</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Ashith Shyam Babu, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> </body> </html>